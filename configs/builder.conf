# Portage Engine Builder Configuration

# Builder server port
BUILDER_PORT=9090

# Number of concurrent build workers
BUILDER_WORKERS=2

# Use Docker/Podman for builds (Gentoo stage3 container)
USE_DOCKER=true

# Container runtime: "docker" or "podman" (default: docker)
# Both runtimes use the same OCI container format
CONTAINER_RUNTIME=docker

# Container image for Gentoo builds
# Can be customized for different mirror sources or private registries
# Examples:
#   gentoo/stage3:latest (Docker Hub)
#   hub.infra.plz.ac/gentoo/stage3:latest (private registry)
#   ghcr.io/gentoo/stage3:latest (GitHub Container Registry)
DOCKER_IMAGE=hub.infra.plz.ac/gentoo/stage3:latest

# Working directories
BUILD_WORK_DIR=/var/tmp/portage-builds
BUILD_ARTIFACT_DIR=/var/tmp/portage-artifacts

# Persistence configuration
DATA_DIR=/var/lib/portage-engine
PERSISTENCE_ENABLED=true
RETENTION_DAYS=7

# ===== Portage Mirror Settings =====
# Mirror URL for portage tree sync (rsync or git)
# Example: rsync://rsync.gentoo.org/gentoo-portage
# Example: https://github.com/gentoo-mirror/gentoo.git
SYNC_MIRROR=

# Mirror URL for distfiles download
# Example: https://distfiles.gentoo.org
# Example: https://mirrors.aliyun.com/gentoo
DISTFILES_MIRROR=

# ===== Host Portage Paths (mounted into Docker) =====
# Path to portage repos directory on host
PORTAGE_REPOS_PATH=/var/db/repos

# Path to portage configuration directory on host
PORTAGE_CONF_PATH=/etc/portage

# Path to make.conf on host
MAKE_CONF_PATH=/etc/portage/make.conf

# GPG signing configuration
# GPG_ENABLED: Enable GPG signing for built packages
GPG_ENABLED=true
# GPG_KEY_ID: Key ID to use for signing (auto-populated if GPG_AUTO_SYNC=true)
GPG_KEY_ID=
# GPG_KEY_PATH: Path to store the GPG public key
GPG_KEY_PATH=
# GPG_AUTO_SYNC: Automatically sync GPG key from server on startup
GPG_AUTO_SYNC=true
# GPG_HOME: Custom GNUPGHOME directory for GPG keys
GPG_HOME=/var/lib/portage-engine/gpg

# Storage configuration
STORAGE_TYPE=local
STORAGE_LOCAL_DIR=/var/binpkgs

# S3 storage configuration (when STORAGE_TYPE=s3)
# STORAGE_S3_BUCKET=my-binpkgs
# STORAGE_S3_REGION=us-east-1
# STORAGE_S3_PREFIX=gentoo/
# AWS_ACCESS_KEY_ID=your-aws-access-key
# AWS_SECRET_ACCESS_KEY=your-aws-secret-key

# HTTP storage configuration (when STORAGE_TYPE=http)
# STORAGE_HTTP_BASE=https://binpkgs.example.com

# Server configuration (for GPG key distribution and artifact upload)
# SERVER_URL=http://localhost:8080

# Notification configuration file path (optional)
# NOTIFY_CONFIG=/path/to/notification.json

# Metrics configuration
METRICS_ENABLED=false
METRICS_PORT=2112
# METRICS_PASSWORD=your-secure-password-here

# Logging configuration
LOG_ENABLED=true
LOG_LEVEL=INFO
LOG_DIR=/var/log/portage-engine
LOG_MAX_SIZE_MB=100
LOG_MAX_AGE_DAYS=30
LOG_MAX_BACKUPS=10
LOG_ENABLE_CONSOLE=true
LOG_ENABLE_FILE=true
SERVER_URL=http://10.42.0.1:8080
